:root{
      --bg:#ffffff; --panel:#f6f7fb; --border:#e5e7eb; --ink:#111827; --muted:#6b7280;
      --pos: rgba(59,130,246,.55);
      --neg: rgba(245,158,11,.55);
      --glow: rgba(16,185,129,.95);
    }
    *{ box-sizing:border-box; }
    html, body{ width:100%; overflow-x:hidden; }
    body{ margin:0; background:var(--bg); color:var(--ink); font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; }

    .topbar{
      display:flex; gap:18px; align-items:flex-end; justify-content:space-between;
      padding:16px 18px; border-bottom:1px solid var(--border); background:#fff;
    }
    .field{ min-width:220px; display:flex; flex-direction:column; gap:6px; color:var(--muted); font-size:13px; }
    .field input, .field select{
      border:none; outline:none; border-bottom:2px solid var(--border);
      padding:8px 4px; font-size:14px; color:var(--ink); background:transparent;
    }
    .statusPill{
      margin-left:auto; border:1px solid var(--border); border-radius:999px;
      padding:6px 10px; font-size:12px; color:var(--muted);
      display:flex; align-items:center; gap:8px; white-space:nowrap;
    }
    .dot{ width:8px; height:8px; border-radius:50%; background:#9ca3af; }
    .dot.playing{ background: var(--glow); }

    .main{
      width:100%;
      max-width:100vw;
      overflow-x:hidden;
      display:grid;
      grid-template-columns: 320px minmax(0, 1fr) 420px;
      gap:18px;
      padding:18px;
      align-items:stretch;
      height: calc(100vh - 74px);
    }

    .panel{
      border:1px solid var(--border); border-radius:14px; background:#fff;
      overflow:hidden; display:flex; flex-direction:column; min-height:0;
      min-width:0;
    }
    .panelHeader{
      padding:12px 12px 10px; background:var(--panel);
      border-bottom:1px solid var(--border); display:flex; align-items:center; justify-content:space-between; gap:10px;
      font-weight:800;
    }
    .panelBody{ padding:14px; min-height:0; overflow:auto; min-width:0; }

    .uploadBox{
      border:2px dashed var(--border); border-radius:16px; padding:14px;
      display:flex; flex-direction:column; gap:12px; align-items:center; justify-content:center;
      min-height: 360px; background:#fff;
    }
    .uploadIcon{ width:180px; height:180px; display:flex; align-items:center; justify-content:center; border-radius:20px; background:#fff; }
    .uploadIcon svg{ width:150px; height:150px; }
    .hint{ color:var(--muted); font-size:13px; text-align:center; line-height:1.4; }
    .preview{ width:100%; border-radius:14px; border:1px solid var(--border); overflow:hidden; display:none; }
    .preview img{ width:100%; display:block; }
    .log{ margin-top:12px; border:1px solid var(--border); border-radius:12px; padding:10px; height: 170px; overflow:auto; font-size:12px; background:#fff; }
    .mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; }

    .centerWrap{ height:100%; display:flex; flex-direction:column; gap:12px; min-height:0; min-width:0; }
    .layerBanner{
      border:1px solid var(--border); border-radius:14px; background:#fff;
      padding:14px; display:flex; align-items:center; justify-content:center; gap:14px; user-select:none;
      min-width:0;
    }
    .layerBanner .btn{
      width:36px; height:36px; display:flex; align-items:center; justify-content:center;
      border-radius:50%; border:1px solid var(--border); background:#fff; font-weight:900; font-size:18px; cursor:pointer;
      flex:0 0 auto;
    }
    .layerBanner .count{ font-weight:900; letter-spacing:.03em; white-space:nowrap; }
    .layerBanner .controls{
      margin-left:auto; display:flex; gap:10px; align-items:center; color:var(--muted); font-size:12px; min-width:0;
      flex-wrap:wrap;
    }
    .layerBanner input{
      width:70px; border:1px solid var(--border); border-radius:8px; padding:6px 8px; font-size:12px;
    }

    .networkStage{
      flex:1;
      border:1px solid var(--border);
      border-radius:14px;
      overflow-x:hidden;
      overflow-y:auto;
      background:#fff;
      min-height:0;
      padding:14px;
      min-width:0;
    }

    svg{
      display:block;
      width:100%;
      height:620px;
    }

    canvas{ width:100%; height:100%; display:block; }
    .chartWrap{ height: 340px; }
    .rightStats{
      display:grid; grid-template-columns: 1fr 1fr; gap:10px;
      padding:12px; border-top:1px solid var(--border); background:#fff;
    }
    .stat{ border:1px solid var(--border); border-radius:12px; padding:10px; }
    .stat .k{ font-size:12px; color:var(--muted); }
    .stat .v{ margin-top:6px; font-weight:900; font-size:18px; }

    /* tooltip for hover after animation */
    #tooltip{
      position:fixed; display:none; z-index:9999;
      background: rgba(17,24,39,.95); color:#fff;
      padding:10px 12px; border-radius:12px; font-size:12px; max-width:360px;
      pointer-events:none; white-space:pre-wrap; box-shadow: 0 10px 30px rgba(0,0,0,.25);
    }

    @media (max-width: 1200px){
      .main{ grid-template-columns: 320px minmax(0,1fr); }
      .main > .panel:last-child{ grid-column: 1 / -1; }
    }
    @media (max-width: 900px){
      .main{ grid-template-columns: 1fr; height:auto; }
    }
    .hiddenControls{
  display:none !important;
}
